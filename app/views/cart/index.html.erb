<div class="container">
  <div class="row">
    <div class="col s12">
      <h4><%= t('cart.cart') %></h4>
      <div><%= link_to t('cart.back'), models_path %></div><br>
        <div class="row">
          <div class="col s6">
            <%= t('cart.username') %> <%= current_user.fname + " " + current_user.lname %><br>
            <%= t('cart.email') %>: <%= current_user.email %><br>
            <%= link_to t('cart.edit_profile'), edit_user_path(current_user) %>
          </div>

          <div class="col s6">
          <% if !current_user.company.nil? %>
            <% company = Company.find(current_user.company_id) %>
            <%= t('cart.company') %> <%= company.title %><br>
            <%= t('cart.address') %> <%= company.street + " " + company.city + " " + company.postal_code%><br>
            <%= t('cart.phone') %> <%= company.phone %><br>
            <br>
          <% end %>
          </div>
        </div>
      <hr/>

      <div class="row">
      <% flash.each do |key, value| %>
        <div class="alert alert-<%= key %> center flash-message"><%= value %></div>
      <% end %>
        <div class="col s8 offset-s2">
          <table>
            <thead>
              <tr>
                <th data-field="model-title"><%= t('cart.product') %></th>
                <th data-field="product-color"><%= t('cart.color') %></th>
                <th data-field="product-size"><%= t('cart.size') %></th>
                <th data-field="quantity"><%= t('cart.quantity') %></th>
                <th data-field="quantity"><%= t('cart.cost') %></th>
                <th colspan="3"></th>
              </tr>
            </thead>
            <tbody>
              <% if @cart.any? %>
                <% total = 0 %>
                <% @cart.each do |id, quantity| %>
                  <% product = Product.find(id) %>
                  <% price = Model.find(product.model_id).price %>
                  <tr><%= render "cart_row", product: product, quantity: quantity, price: price %></tr>
                  <% total += quantity.to_i * price %>
                <% end %>
              <% end %>          
            </tbody>
          </table>
        </div>
      </div>

      <h6 class="right"><b>Total cost: </b><%= sprintf "%.2f", total %></h6>

      <br>
      <br>
      <br>
      <div class="align-right">
        <%= link_to t('cart.confirm_order'), purchases_path, method: :post, :class => "btn waves-effect waves-light right" %></div>
      <div><%= link_to t('cart.empty_cart'), cart_clear_path, :class => "btn waves-effect waves-light left" %></div>
    </div>
  </div>
</div>


